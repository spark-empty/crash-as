/*
* Configuration of module: Dem
*
* Created by:   parai
* Copyright:    (C)parai@foxmail.com  
*
* Configured for (MCU):    posix
*
* Module vendor:           ArcCore
* Generator version:       01.00
*
* Generated by easySAR Studio (https://github.com/parai/as)
*/
#ifdef USE_DEM
/* ============================ [ INCLUDES  ] ====================================================== */
#include "Dem.h"

#ifdef USE_NVM
#include "NvM.h"
#endif
#ifdef USE_DCM
#include "Dcm.h"
#endif
/* ============================ [ MACROS    ] ====================================================== */
#define INDEX_OF_FFIDCLASS_AirbagFFIdClass 0
#define INDEX_OF_FFCLASS_AirbagFreezeFrameClass 0
#define INDEX_OF_EDRC_ExtendedDataRecordClass_Odometer 0
/* ============================ [ TYPES     ] ====================================================== */
/* ============================ [ DECLARES  ] ====================================================== */
#if defined(USE_DCM)
extern Std_ReturnType Dem_DidConditionCheckReadFnc_AirbagFFIdClass(Dcm_NegativeResponseCodeType *Nrc);
#else
extern Std_ReturnType Dem_DidConditionCheckReadFnc_AirbagFFIdClass(uint8 *Nrc);
#endif
extern Std_ReturnType Dem_DidReadDataLengthFnc_AirbagFFIdClass(uint16 *DidLength);
extern Std_ReturnType Dem_DidReadFnc_AirbagFFIdClass(uint8 *Data);
extern Std_ReturnType Dem_PidReadFnc_AirbagFFIdClass(uint8 *DataValueBuffer);
extern Std_ReturnType Dem_CallbackGetExtDataRecord_ExtendedDataRecordClass_Odometer(uint8 *ExtendedDataRecord);
extern Std_ReturnType Dem_CallbackInitMForEFnc_AIRBAG_FAILED(Dem_InitMonitorKindType InitMonitorKind);
/* ============================ [ DATAS     ] ====================================================== */
static const Dem_PidOrDidType Dem_PidOrDid[]=
{
	{ /* AirbagFFIdClass */
		.DidConditionCheckReadFnc=Dem_DidConditionCheckReadFnc_AirbagFFIdClass,
		.DidIdentifier=0xFFFF,
		.DidReadDataLengthFnc=Dem_DidReadDataLengthFnc_AirbagFFIdClass,
		.DidReadFnc=Dem_DidReadFnc_AirbagFFIdClass,
		.PidIndentifier=1,
		.PidOrDidSize=1,
		.PidOrDidUsePort=FALSE,
		.PidReadFnc=Dem_PidReadFnc_AirbagFFIdClass,
	},
};

static const Dem_ExtendedDataRecordClassType Dem_ExtendedDataRecord[]=
{
	{ /* ExtendedDataRecordClass_Odometer */
		.RecordNumber=1,
		.DataSize=4,
		.UpdateRule=DEM_UPDATE_RECORD_VOLATILE,
		.CallbackGetExtDataRecord=Dem_CallbackGetExtDataRecord_ExtendedDataRecordClass_Odometer,
		.InternalDataElement=DEM_NO_ELEMENT,
	},
};

static const Dem_DTCClassType DTCClassRef_DTCAirbag=
{
	.DTC=0x180001,
	.DTCFunctionalUnit=0,
	.DTCKind=DEM_DTC_KIND_ALL_DTCS,
};

static const Dem_EventClassType EventClass_BSWEventClass = 
{
	.ConsiderPtoStatus=FALSE,
	.EventDestination={ DEM_DTC_ORIGIN_PRIMARY_MEMORY },
	.EventPriority=1,
	.FFPrestorageSupported=FALSE,
	.HealingAllowed=FALSE,
	.OperationCycleRef=DEM_IGNITION,
	.HealingCycleRef=DEM_IGNITION,
	.HealingCycleCounter=8,
	.ConfirmationCycleCounterThreshold=8,
};

static const Dem_EventClassType EventClass_SWCEventClass = 
{
	.ConsiderPtoStatus=FALSE,
	.EventDestination={ DEM_DTC_ORIGIN_PRIMARY_MEMORY },
	.EventPriority=1,
	.FFPrestorageSupported=FALSE,
	.HealingAllowed=FALSE,
	.OperationCycleRef=DEM_IGNITION,
	.HealingCycleRef=DEM_IGNITION,
	.HealingCycleCounter=8,
	.ConfirmationCycleCounterThreshold=8,
};

static const Dem_PidOrDidType *AirbagFreezeFrameClass_FFIdClassRef[] = 
{
	&Dem_PidOrDid[INDEX_OF_FFIDCLASS_AirbagFFIdClass],
	NULL
};

static const Dem_FreezeFrameClassType Dem_FreezeFrameClass[]=
{
	{ /* AirbagFreezeFrameClass */
		.FFKind=DEM_FREEZE_FRAME_NON_OBD,
		.FFRecordNumber=1,
		.FFStorageCondition=DEM_FF_STORAGE_FAILED,
		.FFIdClassRef=AirbagFreezeFrameClass_FFIdClassRef,
	},
};

static const Dem_FreezeFrameClassType *AIRBAG_FAILED_FreezeFrameClassRef[] = 
{
	&Dem_FreezeFrameClass[INDEX_OF_FFCLASS_AirbagFreezeFrameClass],
	NULL
};

static const Dem_ExtendedDataRecordClassType *AIRBAG_FAILED_ExtendedDataClassRef[] = 
{
	&Dem_ExtendedDataRecord[INDEX_OF_EDRC_ExtendedDataRecordClass_Odometer],
	NULL
};

static const Dem_EventParameterType EventParameterList[] = 
{
	{
		.EventID=EEP_E_WRITE_FAILED,
		.EventKind=DEM_EVENT_KIND_BSW,
		.EventClass=&EventClass_BSWEventClass,
		.FreezeFrameClassRef=NULL,
		.ExtendedDataClassRef=NULL,
		.CallbackInitMForEFnc=NULL,
		.DTCClassRef=NULL,
		.Arc_EOL=FALSE,
	},
	{
		.EventID=EEP_E_READ_FAILED,
		.EventKind=DEM_EVENT_KIND_BSW,
		.EventClass=&EventClass_BSWEventClass,
		.FreezeFrameClassRef=NULL,
		.ExtendedDataClassRef=NULL,
		.CallbackInitMForEFnc=NULL,
		.DTCClassRef=NULL,
		.Arc_EOL=FALSE,
	},
	{
		.EventID=FLS_E_ERASE_FAILED,
		.EventKind=DEM_EVENT_KIND_BSW,
		.EventClass=&EventClass_BSWEventClass,
		.FreezeFrameClassRef=NULL,
		.ExtendedDataClassRef=NULL,
		.CallbackInitMForEFnc=NULL,
		.DTCClassRef=NULL,
		.Arc_EOL=FALSE,
	},
	{
		.EventID=FLS_E_WRITE_FAILED,
		.EventKind=DEM_EVENT_KIND_BSW,
		.EventClass=&EventClass_BSWEventClass,
		.FreezeFrameClassRef=NULL,
		.ExtendedDataClassRef=NULL,
		.CallbackInitMForEFnc=NULL,
		.DTCClassRef=NULL,
		.Arc_EOL=FALSE,
	},
	{
		.EventID=FLS_E_READ_FAILED,
		.EventKind=DEM_EVENT_KIND_BSW,
		.EventClass=&EventClass_BSWEventClass,
		.FreezeFrameClassRef=NULL,
		.ExtendedDataClassRef=NULL,
		.CallbackInitMForEFnc=NULL,
		.DTCClassRef=NULL,
		.Arc_EOL=FALSE,
	},
	{
		.EventID=CANNM_E_NETWORK_TIMEOUT,
		.EventKind=DEM_EVENT_KIND_BSW,
		.EventClass=&EventClass_BSWEventClass,
		.FreezeFrameClassRef=NULL,
		.ExtendedDataClassRef=NULL,
		.CallbackInitMForEFnc=NULL,
		.DTCClassRef=NULL,
		.Arc_EOL=FALSE,
	},
	{
		.EventID=PDUR_E_PDU_INSTANCE_LOST,
		.EventKind=DEM_EVENT_KIND_BSW,
		.EventClass=&EventClass_BSWEventClass,
		.FreezeFrameClassRef=NULL,
		.ExtendedDataClassRef=NULL,
		.CallbackInitMForEFnc=NULL,
		.DTCClassRef=NULL,
		.Arc_EOL=FALSE,
	},
	{
		.EventID=NVM_E_INTEGRITY_FAILED,
		.EventKind=DEM_EVENT_KIND_BSW,
		.EventClass=&EventClass_BSWEventClass,
		.FreezeFrameClassRef=NULL,
		.ExtendedDataClassRef=NULL,
		.CallbackInitMForEFnc=NULL,
		.DTCClassRef=NULL,
		.Arc_EOL=FALSE,
	},
	{
		.EventID=NVM_E_REQ_FAILED,
		.EventKind=DEM_EVENT_KIND_BSW,
		.EventClass=&EventClass_BSWEventClass,
		.FreezeFrameClassRef=NULL,
		.ExtendedDataClassRef=NULL,
		.CallbackInitMForEFnc=NULL,
		.DTCClassRef=NULL,
		.Arc_EOL=FALSE,
	},
	{
		.EventID=ECUM_E_ALL_RUN_REQUESTS_KILLED,
		.EventKind=DEM_EVENT_KIND_BSW,
		.EventClass=&EventClass_BSWEventClass,
		.FreezeFrameClassRef=NULL,
		.ExtendedDataClassRef=NULL,
		.CallbackInitMForEFnc=NULL,
		.DTCClassRef=NULL,
		.Arc_EOL=FALSE,
	},
	{
		.EventID=ECUM_E_RAM_CHECK_FAILED,
		.EventKind=DEM_EVENT_KIND_BSW,
		.EventClass=&EventClass_BSWEventClass,
		.FreezeFrameClassRef=NULL,
		.ExtendedDataClassRef=NULL,
		.CallbackInitMForEFnc=NULL,
		.DTCClassRef=NULL,
		.Arc_EOL=FALSE,
	},
	{
		.EventID=DEM_EVENT_ID_AIRBAG_FAILED,
		.EventKind=DEM_EVENT_KIND_SWC,
		.EventClass=&EventClass_SWCEventClass,
		.FreezeFrameClassRef=AIRBAG_FAILED_FreezeFrameClassRef,
		.ExtendedDataClassRef=AIRBAG_FAILED_ExtendedDataClassRef,
		.CallbackInitMForEFnc=Dem_CallbackInitMForEFnc_AIRBAG_FAILED,
		.DTCClassRef=&DTCClassRef_DTCAirbag,
		.Arc_EOL=FALSE,
	},
	{
		.Arc_EOL=TRUE
	}
};

static const Dem_ConfigSetType DemConfig = 
{
	.EventParameter=EventParameterList,
};

const Dem_ConfigType DEM_Config = { .ConfigSet = &DemConfig };

#ifdef USE_NVM
FreezeFrameRecType * const FreezeFrameMirrorBuffer[DEM_MAX_NUMBER_FF_DATA_PRI_MEM] = 
{
	(FreezeFrameRecType*)&NvM_Block_DemFreezeFrame_DataGroup_RAM[0],
	(FreezeFrameRecType*)&NvM_Block_DemFreezeFrame_DataGroup_RAM[1],
	(FreezeFrameRecType*)&NvM_Block_DemFreezeFrame_DataGroup_RAM[2],
	(FreezeFrameRecType*)&NvM_Block_DemFreezeFrame_DataGroup_RAM[3],
	(FreezeFrameRecType*)&NvM_Block_DemFreezeFrame_DataGroup_RAM[4],
};

const NvM_BlockIdType FreezeFrameBlockId[DEM_MAX_NUMBER_FF_DATA_PRI_MEM] = 
{
	NVM_BLOCK_ID_DemFreezeFrame_0,
	NVM_BLOCK_ID_DemFreezeFrame_1,
	NVM_BLOCK_ID_DemFreezeFrame_2,
	NVM_BLOCK_ID_DemFreezeFrame_3,
	NVM_BLOCK_ID_DemFreezeFrame_4,
};

const NvM_BlockIdType HealingBlockId = NVM_BLOCK_ID_DemHealing;
#endif /* USE_DCM */

/* ============================ [ LOCALS    ] ====================================================== */
/* ============================ [ FUNCTIONS ] ====================================================== */
#endif
